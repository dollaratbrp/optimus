from Import_Functions import *
from ParametersBox import *

if not OpenParameters():  # If user cancel request
    sys.exit()


# -------------------------------------------------------------------------------------------------------------------------------------------------------------------#
# -------------------------------------------------------------------------------------------------------------------------------------------------------------------#
                                                                     #MODIFICATIONS SECTION
# -------------------------------------------------------------------------------------------------------------------------------------------------------------------#
# -------------------------------------------------------------------------------------------------------------------------------------------------------------------#
dayTodayComplete= pd.datetime.now().replace(second=0, microsecond=0)
dayToday= weekdays(0)

saveFolder='S:\Shared\Business_Planning\Personal\Lefebvre\S2\p2p\p2p_Project\p2p_Project\\' #Folder to save data
dest_filename = 'P2P_Summary_'+dayToday #Name of excel file with today's date
#-------------------------------------------------------------------------------------------------------------------------------------------------------------------#
#-------------------------------------------------------------------------------------------------------------------------------------------------------------------#
                                                                        #END OF MODIFICATIONS
#-------------------------------------------------------------------------------------------------------------------------------------------------------------------#
#-------------------------------------------------------------------------------------------------------------------------------------------------------------------#



#####################################################################################################################
                                                ###Get SQL DATA
#####################################################################################################################

##If SQL querries crash
downloaded = False
numberOfTry = 0
#while (not downloaded and numberOfTry<3): # 3 trials, SQL Queries sometime crash for no reason
##########
numberOfTry+=1
downloaded = True
#    try:
########## ##########

        ####################################################################################
                           ###  Email adress Query
        ####################################################################################
        ###Use class
#sqlEmail=""" SELECT distinct [EMAIL_ADDRESS]
#  FROM [Business_Planning].[dbo].[OTD_1_SHIPPING_F_CANADIAN_LOADS_EMAIL_ADDRESS]
#"""
# GET SQL DATA
#EmailList = [ item for sublist in GetSQLData('CAVLSQLPD2\pbi2', 'Business_Planning',sqlEmail) for item in sublist]


        ####################################################################################
                           ###  WishList Query
        ####################################################################################




        ####################################################################################
                           ###  INV Querry
        ####################################################################################



        ####################################################################################
                           ###  Parameters Query
        ####################################################################################

#    except:
#        downloaded=False
#        print('SQL Query failed')  

#If SQL Queries failed 
if downloaded== False:
    #Send email ##############################################################################################################################
    sys.exit()



#####################################################################################################################
                                                ### Excel Workbook declaration
#####################################################################################################################


wb = Workbook()

### Approved loads
wsApproved = wb.active
wsApproved.title = "Approved"
wsApproved.append([''])
wsApprovedList = []

                  
### Unbooked
wsUnbooked = wb.create_sheet("Unbooked")
wsUnbooked.append([''])
wsUnbookedList=[]



#####################################################################################################################
                                                ### Lists declaration
#####################################################################################################################







#####################################################################################################################
                                                ###Isolate perfect match
#####################################################################################################################





